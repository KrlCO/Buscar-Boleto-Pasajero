<?xml version="1.0" encoding="utf-8"?>
<!--
  ARCHIVO DE CONFIGURACIÓN DE EJEMPLO PARA IIS
  
  INSTRUCCIONES:
  1. Copia este archivo como 'web.config'
  2. Reemplaza las rutas de ejemplo con las rutas reales de tu servidor
  3. Ajusta las configuraciones según tu entorno
  4. Asegúrate de que web.config esté en .gitignore si contiene información sensible
-->
<configuration>
  <system.webServer>
    <!-- Configuración de handlers para Python FastCGI -->
    <handlers>
      <add name="Python FastCGI" 
           path="*" 
           verb="*" 
           modules="FastCgiModule" 
           scriptProcessor="[RUTA_PYTHON]\python.exe|[RUTA_PYTHON]\Lib\site-packages\wfastcgi.py" 
           resourceType="Unspecified" 
           requireAccess="Script" />
    </handlers>
    
    <!-- Documento por defecto -->
    <defaultDocument>
      <files>
        <clear />
        <add value="app_iis.py" />
      </files>
    </defaultDocument>
    
    <!-- Configuración de errores personalizados -->
    <httpErrors errorMode="Detailed" />
    
    <!-- Configuración de compresión -->
    <httpCompression>
      <dynamicTypes>
        <add mimeType="text/html" enabled="true" />
        <add mimeType="text/css" enabled="true" />
        <add mimeType="application/javascript" enabled="true" />
        <add mimeType="application/json" enabled="true" />
      </dynamicTypes>
      <staticTypes>
        <add mimeType="text/css" enabled="true" />
        <add mimeType="application/javascript" enabled="true" />
      </staticTypes>
    </httpCompression>
    
    <!-- Headers de seguridad -->
    <httpProtocol>
      <customHeaders>
        <add name="X-Content-Type-Options" value="nosniff" />
        <add name="X-Frame-Options" value="DENY" />
        <add name="X-XSS-Protection" value="1; mode=block" />
        <add name="Referrer-Policy" value="strict-origin-when-cross-origin" />
      </customHeaders>
    </httpProtocol>
    
    <!-- Configuración de archivos estáticos -->
    <staticContent>
      <mimeMap fileExtension=".json" mimeType="application/json" />
      <mimeMap fileExtension=".woff" mimeType="application/font-woff" />
      <mimeMap fileExtension=".woff2" mimeType="application/font-woff2" />
    </staticContent>
    
    <!-- Configuración de caché -->
    <caching>
      <profiles>
        <add extension=".css" policy="CacheUntilChange" kernelCachePolicy="CacheUntilChange" duration="1.00:00:00" />
        <add extension=".js" policy="CacheUntilChange" kernelCachePolicy="CacheUntilChange" duration="1.00:00:00" />
        <add extension=".png" policy="CacheUntilChange" kernelCachePolicy="CacheUntilChange" duration="7.00:00:00" />
        <add extension=".jpg" policy="CacheUntilChange" kernelCachePolicy="CacheUntilChange" duration="7.00:00:00" />
        <add extension=".gif" policy="CacheUntilChange" kernelCachePolicy="CacheUntilChange" duration="7.00:00:00" />
      </profiles>
    </caching>
    
    <!-- Configuración de URL Rewrite (opcional para HTTPS) -->
    <!--
    <rewrite>
      <rules>
        <rule name="Redirect to HTTPS" stopProcessing="true">
          <match url="(.*)" />
          <conditions>
            <add input="{HTTPS}" pattern="off" ignoreCase="true" />
          </conditions>
          <action type="Redirect" url="https://{HTTP_HOST}/{R:1}" redirectType="Permanent" />
        </rule>
      </rules>
    </rewrite>
    -->
  </system.webServer>
  
  <!-- Configuración de la aplicación Python -->
  <appSettings>
    <!-- Handler principal de la aplicación Flask -->
    <add key="WSGI_HANDLER" value="app_iis.application" />
    
    <!-- Path de Python para la aplicación - REEMPLAZAR CON TU RUTA -->
    <add key="PYTHONPATH" value="[RUTA_APLICACION]" />
    
    <!-- Archivo de logs de la aplicación - REEMPLAZAR CON TU RUTA -->
    <add key="WSGI_LOG" value="[RUTA_APLICACION]\logs\wsgi.log" />
    
    <!-- Configuración de restart de la aplicación -->
    <add key="WSGI_RESTART_FILE_REGEX" value=".*((app_iis|app|config)\.py)$" />
    
    <!-- Configuración de timeout -->
    <add key="SCRIPT_TIMEOUT" value="600" />
    
    <!-- Variables de entorno para la aplicación -->
    <add key="FLASK_ENV" value="production" />
    <add key="FLASK_DEBUG" value="0" />
    
    <!-- Información del servidor - COMPLETAR SEGÚN TU ENTORNO -->
    <add key="SERVER_INFO" value="[TU_SERVIDOR_INFO]" />
    <add key="SERVER_IP" value="[TU_IP_SERVIDOR]" />
  </appSettings>
  
  <!-- Configuración de conexión a base de datos (si es necesario) -->
  <connectionStrings>
    <!-- Ejemplo de connection string - AJUSTAR SEGÚN TU BASE DE DATOS -->
    <!--
    <add name="DefaultConnection" 
         connectionString="Driver={ODBC Driver 17 for SQL Server};Server=[TU_SERVIDOR];Database=[TU_BASE_DATOS];Trusted_Connection=yes;" 
         providerName="System.Data.Odbc" />
    -->
  </connectionStrings>
  
  <!-- Configuración del runtime -->
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <!-- Configuraciones de ensamblado si son necesarias -->
    </assemblyBinding>
  </runtime>
</configuration>